#include <iostream>
#include <cmath>
#include <iomanip>

using namespace std;

// функция для вычисления значения y в зависимости от x
double calculateY(double x) {
    // если x в диапазоне от -5 до -2 (включительно)
    if (x >= -5 && x <= -2) {
        // вычисляем y для прямой, проходящей через точки (-5,-1) и (-2,0)
        // уравнение прямой: (y - y1)/(y2 - y1) = (x - x1)/(x2 - x1)
        return (1.0 / 3.0) * (x + 5) - 1;
    }
    // если x в диапазоне от -2 до 0 (не включая 0)
    else if (x > -2 && x < 0) {
        // горизонтальная линия y=0
        return 0.5 * (x + 2) - 1;
    }
    // если x в диапазоне от 0 до 2 (не включая 2)
    else if (x >= 0 && x < 2) {
        // вычисляем тангенс от x/2
        return tan(x / 2.0);
    }
    // если x в диапазоне от 2 до 3 (не включая 3)
    else if (x >= 2 && x < 3) {
        // прямая, проходящая через точки (2,tan(1)) и (3,0)
        // угловой коэффициент k = (0 - tan(1))/(3 - 2) = -tan(1)
        return -tan(1.0) * (x - 2) + tan(1.0);
    }
    // если x в диапазоне от 3 до 5 (включительно)
    else if (x >= 3 && x <= 5) {
        // прямая, проходящая через точки (3,0) и (5,1)
        // угловой коэффициент k = (1 - 0)/(5 - 3) = 0.5
        return 0.5 * (x - 3);
    }
    // если x вне заданного диапазона
    else {
        // возвращаем "не число" (nan)
        return NAN;
    }
}

int main() {
    // объявление переменных для границ интервала и шага
    double xstart, xend, dx;

    // запрос начального значения x
    cout << "введите начальное значение x (от -5 до 5): ";
    cin >> xstart;

    // запрос конечного значения x
    cout << "введите конечное значение x (от -5 до 5): ";
    cin >> xend;

    // запрос шага вычислений
    cout << "введите шаг dx (положительное число): ";
    cin >> dx;

    // проверка корректности введенных данных
    if (xstart < -5 || xend > 5 || xstart > xend || dx <= 0) {
        cout << "ошибка: некорректные входные данные." << endl;
        cout << "убедитесь, что:" << endl;
        cout << "- начальное x >= -5" << endl;
        cout << "- конечное x <= 5" << endl;
        cout << "- начальное x <= конечное x" << endl;
        cout << "- шаг dx > 0" << endl;
        return 1;
    }

    // вывод заголовка таблицы
    cout << "-----------------------------" << endl;
    cout << "|     x     |      y      |" << endl;
    cout << "-----------------------------" << endl;

    // основной цикл вычисления и вывода значений функции
    // используем <= для xend, чтобы включить конечную точку
    for (double x = xstart; x <= xend; x += dx) {
        // вычисление значения функции
        double y = calculateY(x);

        // вывод значения x с фиксированной точностью и выравниванием
        cout << "| " << setw(9) << fixed << setprecision(3) << x << " | ";
        
        // проверка на корректность значения y
        if (!isnan(y)) {
            // проверка на очень большие значения (например, тангенс стремится к бесконечности)
            if (y > 10 || y < -10) {
                cout << "  очень бол. |";
            } else {
                // вывод корректного значения y с фиксированной точностью
                cout << setw(10) << fixed << setprecision(3) << y << " |";
            }
        } else {
            // вывод сообщения для неопределенных значений
            cout << "   не опр.  |";
        }
        cout << endl;
    }

    // завершающая линия таблицы
    cout << "-----------------------------" << endl;

    return 0;  // завершение программы с кодом 0 (успех)
}